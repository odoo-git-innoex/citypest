<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="tax_invoice_template_id">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="o">
                <t t-call="web.basic_layout">
                    <t t-call="sale_custom.tax_invoice_header" />
                    <div class="page">
                        <div style="text-align:center;border:1px solid black;font-size:20px;font-weight:bold;padding-top:10px;padding-bottom:10px;">TAX INVOICE / فاتورة ضريبية</div>
                        <table width="100%" style="margin-top:20px; border:1px solid black; border-collapse:collapse; font-size:13px;">
                            <tr>
                                <!-- ================= LEFT COLUMN : CUSTOMER ================= -->
                                <td style="vertical-align:top; width:50%; border-right:1px solid black; padding:0;">
                                    <div style="border-bottom:1px solid black; width:100%; text-align:center; padding:6px;">
                                        <strong>Customer / العميل</strong>
                                    </div>
                                    <div style="padding:6px;">
                                        <strong>
                                            <span t-field="o.partner_id.name" />
                                        </strong>
                                        <br />
                                        <span t-field="o.partner_id.contact_address" />
                                        <br />
                                        <table width="100%" style="border-collapse:collapse;">
                                            <tr>
                                                <td style="text-align:left;border:hidden">
                                                    <strong>TRN</strong>
                                                </td>
                                                <td style="text-align:right;border:hidden" dir="rtl">
                                                    <strong />
                                                </td>
                                            </tr>
                                        </table>
                                        <span t-field="o.partner_id.vat" />
                                    </div>
                                </td>
                                <!-- ================= RIGHT COLUMN : INVOICE INFO ================= -->
                                <td style="vertical-align:top; width:50%; padding:0;">
                                    <table width="100%" style="border-collapse:collapse; font-size:13px;">
                                        <!-- ================= DATE ================= -->
                                        <tr>
                                            <td style="padding:6px; border-bottom:1px solid black;">
                                                <table width="100%" style="border:hidden">
                                                    <tr>
                                                        <td style="text-align:left;border:hidden">
                                                            <strong>Date</strong>
                                                        </td>
                                                        <td style="text-align:right;border:hidden" dir="rtl">
                                                            <strong>التاريخ</strong>
                                                        </td>
                                                    </tr>
                                                </table>
                                            </td>
                                            <td style="padding:6px; border-left:1px solid black; border-bottom:1px solid black; text-align:center;">
                                                <span t-field="o.invoice_date" />
                                            </td>
                                        </tr>
                                        <!-- ================= INV NO ================= -->
                                        <tr>
                                            <td style="padding:6px; border-bottom:1px solid black;">
                                                <table width="100%" style="border:hidden">
                                                    <tr>
                                                        <td style="text-align:left;border:hidden">
                                                            <strong>INV. No.</strong>
                                                        </td>
                                                        <td style="text-align:right;border:hidden" dir="rtl">
                                                            <strong>رقم الفاتورة</strong>
                                                        </td>
                                                    </tr>
                                                </table>
                                            </td>
                                            <td style="padding:6px; border-left:1px solid black; border-bottom:1px solid black; text-align:center;">
                                                <span t-field="o.name" />
                                            </td>
                                        </tr>
                                        <!-- ================= PAYMENT ================= -->
                                        <tr>
                                            <td style="padding:6px; border-bottom:1px solid black;">
                                                <table width="100%" style="border:hidden">
                                                    <tr>
                                                        <td style="text-align:left;border:hidden">
                                                            <strong>Payment By</strong>
                                                        </td>
                                                        <td style="text-align:right;border:hidden" dir="rtl">
                                                            <strong>طريقة الدفع</strong>
                                                        </td>
                                                    </tr>
                                                </table>
                                            </td>
                                            <td style="padding:6px; border-left:1px solid black; border-bottom:1px solid black; text-align:center;">
                                                <t t-set="payments" t-value="o._get_reconciled_payments()" />
                                                <t t-if="payments">
                                                    <t t-foreach="payments" t-as="p">
                                                        <t t-esc="p.journal_id.name" />
                                                    </t>
                                                </t>
                                            </td>
                                        </tr>
                                        <!-- ================= LPO ================= -->
                                        <tr>
                                            <td style="padding:6px; border-bottom:1px solid black;">
                                                <table width="100%">
                                                    <tr>
                                                        <td style="text-align:left;border:hidden">
                                                            <strong>L.P.O. No.</strong>
                                                        </td>
                                                        <td style="text-align:right;border:hidden" dir="rtl">
                                                            <strong>رقم طلب الشراء</strong>
                                                        </td>
                                                    </tr>
                                                </table>
                                            </td>
                                            <td style="padding:6px; border-left:1px solid black; border-bottom:1px solid black; text-align:center;">
                                                <span t-esc="o.lpo_number" />
                                            </td>
                                        </tr>
                                        <!-- ================= DO ================= -->
                                        <tr>
                                            <td style="padding:6px;border-bottom:1px solid black;">
                                                <table width="100%">
                                                    <tr>
                                                        <td style="text-align:left;border:hidden">
                                                            <strong>D.O. No.</strong>
                                                        </td>
                                                        <td style="text-align:right;border:hidden" dir="rtl">
                                                            <strong>رقم أمر التسليم</strong>
                                                        </td>
                                                    </tr>
                                                </table>
                                            </td>
                                            <td style="padding:6px; border-left:1px solid black;border-bottom:1px solid black;text-align:center;">
                                                <span t-esc="o.do_number" />
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="padding:6px;">
                                                <table width="100%" style="border:hidden">
                                                    <tr>
                                                        <td style="text-align:left;border:hidden">
                                                            <strong>Payment Terms.</strong>
                                                        </td>
                                                        <td style="text-align:right;border:hidden" dir="rtl">
                                                            <strong>شروط الدفع</strong>
                                                        </td>
                                                    </tr>
                                                </table>
                                            </td>
                                            <td style="padding:6px; border-left:1px solid black; text-align:center;">
                                                <span t-esc="o.invoice_payment_term_id.name" />
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                        </table>
                        <br />
                        <table class="table" style="width:100%; border-collapse:collapse; border:1px solid black;">
                            <thead>
                                <tr>
                                    <th style="width:5%; border:1px solid black;">
                                        الرقم
                                        <br />
                                        No.
                                    </th>
                                    <th style="width:40%; border:1px solid black;">
                                        التفاصيل
                                        <br />
                                        DESCRIPTION
                                    </th>
                                    <th style="width:10%; border:1px solid black;">
                                        الكمية
                                        <br />
                                        Qty
                                    </th>
                                    <th style="width:10%; border:1px solid black;">
                                        الوحدة
                                        <br />
                                        UOM
                                    </th>
                                    <th style="width:10%; border:1px solid black;">
                                        السعر
                                        <br />
                                        U. Price
                                    </th>
                                    <th style="width:10%; border:1px solid black;">
                                        الضريبة
                                        <br />
                                        VAT (%)
                                    </th>
                                    <th style="width:15%; border:1px solid black;">
                                        المبلغ
                                        <br />
                                        Amount
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                <t t-set="sl" t-value="0" />
                                <t t-foreach="o.invoice_line_ids" t-as="line">
                                    <t t-if="line.display_type == 'product'">
                                        <tr>
                                            <td style="border:1px solid black;">
                                                <t t-set="sl" t-value="sl+1" />
                                                <span t-esc="sl" />
                                            </td>
                                            <td style="border:1px solid black;">
                                                <span t-esc="line.name" />
                                            </td>
                                            <td style="border:1px solid black;text-align:center">
                                                <span t-esc="int(line.quantity)" />
                                            </td>
                                            <td style="border:1px solid black;">
                                                <span t-esc="line.product_uom_id.name" />
                                            </td>
                                            <td style="border:1px solid black; text-align:right;">
                                                <span t-esc="line.price_unit" />
                                            </td>
                                            <td style="border:1px solid black; text-align:right;">
                                                <span t-esc="', '.join([str(t.amount) for t in line.tax_ids])" />
                                            </td>
                                            <td style="border:1px solid black; text-align:right;">
                                                <span t-esc="line.price_subtotal" />
                                            </td>
                                        </tr>
                                    </t>
                                    <t t-elif="line.display_type == 'line_section'">
                                        <tr>
                                            <td colspan="7" style="border:1px solid black; background-color: #f2f2f2; font-weight: bold;">
                                                <span t-field="line.name" />
                                            </td>
                                        </tr>
                                    </t>
                                    <t t-elif="line.display_type == 'line_note'">
                                        <tr>
                                            <td colspan="7" style="border:1px solid black; font-style: italic;">
                                                <span t-field="line.name" />
                                            </td>
                                        </tr>
                                    </t>
                                </t>
                            </tbody>
                            <t t-if="6 > len(o.invoice_line_ids)">
                                <tr style="height:200px;">
                                    <td style="border:1px solid black;" />
                                    <td style="border:1px solid black;" />
                                    <td style="border:1px solid black;" />
                                    <td style="border:1px solid black;" />
                                    <td style="border:1px solid black;text-align:right" />
                                    <td style="border:1px solid black;text-align:right" />
                                    <td style="border:1px solid black;text-align:right" />
                                </tr>
                            </t>
                            <!-- TOTALS ROWS -->
                            <tr>
                                <!-- ROWSPAN CELL: AMOUNT IN WORDS -->
                                <td colspan="3" rowspan="3" style="border:1px solid black; padding:8px; vertical-align:top;">
                                    <strong>Total Amount:</strong>
                                    <br />
                                    <span t-esc="o.currency_id.amount_to_text(o.amount_total)" />
                                </td>
                                <td colspan="3" style="border:1px solid black; padding:5px;">
                                    <table width="100%" style="border-collapse:collapse;border:hidden;">
                                        <tr>
                                            <td style="text-align:left;border:hidden;">
                                                <strong>Subtotal</strong>
                                            </td>
                                            <td style="text-align:right;border:hidden;" dir="rtl">
                                                <strong>المجموع الفرعي</strong>
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                                <td style="border:1px solid black; padding:5px;" align="right">
                                    <span t-field="o.amount_untaxed" />
                                </td>
                            </tr>
                            <tr>
                                <td colspan="3" style="border:1px solid black; padding:5px;">
                                    <table width="100%" style="border-collapse:collapse;border:hidden;">
                                        <tr>
                                            <td style="text-align:left;border:hidden;">
                                                <strong>Total VAT</strong>
                                            </td>
                                            <td style="text-align:right;border:hidden;" dir="rtl">
                                                <strong>مجموع الضريبة</strong>
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                                <td style="border:1px solid black; padding:5px;" align="right">
                                    <span t-field="o.amount_tax" />
                                </td>
                            </tr>
                            <tr>
                                <td colspan="3" style="border:1px solid black; padding:5px;">
                                    <table width="100%" style="border-collapse:collapse;border:hidden;">
                                        <tr>
                                            <td style="text-align:left;border:hidden;">
                                                <strong>Total Amount</strong>
                                            </td>
                                            <td style="text-align:right;border:hidden;" dir="rtl">
                                                <strong>المبلغ الإجمالي</strong>
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                                <td style="border:1px solid black; padding:5px;" align="right">
                                    <span t-field="o.amount_total" />
                                </td>
                            </tr>
                            <tr>
                                <td colspan="7" style="border:1px solid black; padding:5px;">
                                    <table width="100%" style="border-collapse:collapse;border:hidden;">
                                        <tr>
                                            <td style="text-align:left;border:hidden;">
                                                <strong>Remarks :</strong>
                                            </td>
                                            <td style="text-align:right;border:hidden;" dir="rtl">
                                                <strong>ملاحظات</strong>
                                            </td>
                                        </tr>
                                    </table>
                                    <t t-esc="o.narration" />
                                </td>
                            </tr>
                        </table>
                        <div style="border:1px solid black; padding:7px;width:100%">
                            Service Date :
                            <span t-field="o.service_date" />
                        </div>
                        <div class="invoice-footer" style="margin-top:30px;">
                            <table style="width:100%;border:hidden">
                                <tr>
                                    <!-- Prepared By (English/Arabic, left side) -->
                                    <td style="border:hidden;width:50%; vertical-align:top;">
                                        <span style="font-weight:bold;">Prepared by :</span>
                                        <span style="text-align:right; margin-left:15px;">__________________________________________</span>
                                        <span style="margin-left:15px;">إعداد</span>
                                    </td>
                                    <!-- Received By (English/Arabic, right side) -->
                                    <td style="border:hidden;width:50%; vertical-align:top;">
                                        <span style="font-weight:bold;">Received by :</span>
                                        <span style="text-align:right; margin-left:10px;">__________________________________________</span>
                                        <span style="margin-left:15px;">المستلم</span>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </t>
            </t>
        </t>
    </template>
</odoo>